!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.CKEditor5=t():(e.CKEditor5=e.CKEditor5||{},e.CKEditor5.uiStylesBlock=t())}(self,(()=>(()=>{var e={"ckeditor5/src/core.js":(e,t,o)=>{e.exports=o("dll-reference CKEditor5.dll")("./src/core.js")},"ckeditor5/src/ui.js":(e,t,o)=>{e.exports=o("dll-reference CKEditor5.dll")("./src/ui.js")},"ckeditor5/src/utils.js":(e,t,o)=>{e.exports=o("dll-reference CKEditor5.dll")("./src/utils.js")},"dll-reference CKEditor5.dll":e=>{"use strict";e.exports=CKEditor5.dll}},t={};function o(s){var i=t[s];if(void 0!==i)return i.exports;var n=t[s]={exports:{}};return e[s](n,n.exports,o),n.exports}o.d=(e,t)=>{for(var s in t)o.o(t,s)&&!o.o(e,s)&&Object.defineProperty(e,s,{enumerable:!0,get:t[s]})},o.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t);var s={};return(()=>{"use strict";o.d(s,{default:()=>a});var e=o("ckeditor5/src/core.js"),t=o("ckeditor5/src/utils.js");class i extends e.Command{constructor(e,t){super(e),this.set("value",[]),this.set("enabledStyles",[]),this._styleDefinitions=t}refresh(){const e=this.editor.model,o=e.document.selection,s=this.editor.plugins.get("GeneralHtmlSupport"),i=this.editor.plugins.get("DataSchema"),r=new Set,l=new Set,c=(0,t.first)(o.getSelectedBlocks());if(c){const t=c.getAncestors({includeSelf:!0,parentFirst:!0});for(const o of t){if(e.schema.isLimit(o))break;const t=i.getDefinitionsForModel(o.name).find((e=>e.model==o.name&&1==e.isBlock));if(void 0===t)continue;const c=s.getGhsAttributeNameForElement(t.view);if(e.schema.checkAttribute(o,c))for(const e of this._styleDefinitions){l.add(e.name);n(o.getAttribute(c),e.classes)&&r.add(e.name)}}}this.enabledStyles=Array.from(l).sort(),this.isEnabled=this.enabledStyles.length>0,this.value=this.isEnabled?Array.from(r).sort():[]}execute({styleName:e}){const t=this.editor.model,o=t.document.selection,s=this.editor.plugins.get("GeneralHtmlSupport"),i=this.editor.plugins.get("DataSchema"),n=this._styleDefinitions.find((({name:t})=>t==e)),r=!this.value.includes(n.name);t.change((()=>{let e;e=function(e,t){const o=new Set;for(const s of e){const e=s.getAncestors({includeSelf:!0,parentFirst:!0});for(const s of e){if(t.isLimit(s))break;o.add(s)}}return o}(o.getSelectedBlocks(),t.schema);for(const t of e){const e=i.getDefinitionsForModel(t.name).find((e=>e.model==t.name&&1==e.isBlock));void 0!==e&&(r?(s.removeModelHtmlClass(e.view,n.excluded_classes,t),s.addModelHtmlClass(e.view,n.classes,t)):s.removeModelHtmlClass(e.view,n.classes,t))}}))}}function n(e,t){return!(!e||!e.classes)&&t.every((t=>e.classes.includes(t)))}class r extends e.Plugin{static get pluginName(){return"UiStylesBlockEditing"}static get requires(){return["GeneralHtmlSupport","DataSchema"]}init(){const e=this.editor,t=function(e=[]){const t=[];for(const o of e)o.options.forEach((e=>{const s=e.name;e.name=`${o.id}:${s}`,t.push({...e})}));return t}(e.config.get("uiStylesBlock.options"));e.commands.add("uiStylesBlock",new i(e,t)),this._defineSchema()}_defineSchema(){const e=this.editor.model.schema,t=this.editor.plugins.get("GeneralHtmlSupport"),o=this.editor.plugins.get("DataSchema");for(const s in e.getDefinitions()){const i=o.getDefinitionsForModel(s).find((e=>e.model==s&&1==e.isBlock));if(void 0===i)continue;const n=t.getGhsAttributeNameForElement(i.view);e.setAttributeProperties(n,{isFormatting:!0})}e.setAttributeProperties("htmlAttributes",{isFormatting:!0})}}var l=o("ckeditor5/src/ui.js");class c extends e.Plugin{static get pluginName(){return"UiStylesBlockUI"}init(){const e=this.editor,t=e.ui.componentFactory,o=Drupal.t,s=e.config.get("uiStylesBlock.options");s.forEach((e=>{this._addButton(e)})),t.add("UiStylesBlock",(i=>{const n=(0,l.createDropdown)(i),r=e.commands.get("uiStylesBlock");n.bind("isEnabled").to(r);const c=[];return s.forEach((e=>{c.push(t.create(`UIStylesBlock:${e.id}`))})),(0,l.addToolbarToDropdown)(n,c,{enableActiveItemFocusOnDropdownOpen:!1,isVertical:!0,ariaLabel:o("UI Styles block toolbar")}),n.buttonView.set({label:o("Styles (block)"),withText:!0,tooltip:!0}),n.bind("class").to(r,"value",(e=>{const t=["ck-ui-styles-block-dropdown"];return e.length>0&&t.push("ck-ui-styles-block-dropdown-active"),t.join(" ")})),this.listenTo(n,"execute",(t=>{e.execute(t.source.commandName,{styleName:t.source.commandParam}),e.editing.view.focus()})),n}))}_addButton(e){const o=this.editor;o.ui.componentFactory.add(`UIStylesBlock:${e.id}`,(s=>{const i=new t.Collection,n=o.commands.get("uiStylesBlock");e.options.forEach((t=>{const o=`${e.id}:${t.name}`,s={type:"button",model:new l.Model({commandName:"uiStylesBlock",commandParam:o,label:t.name,withText:!0})};s.model.bind("isOn").to(n,"value",(e=>!!e.includes(o))),i.add(s)}));const r=(0,l.createDropdown)(s);return(0,l.addListToDropdown)(r,i),r.buttonView.set({label:e.label,withText:!0}),r.bind("class").to(n,"value",(t=>{const o=["ck-ui-styles-block-dropdown-style-dropdown"];return t.find((t=>t.includes(`${e.id}`)))&&o.push("ck-ui-styles-block-dropdown-style-dropdown-active"),o.join(" ")})),r}))}}class d extends e.Plugin{static get pluginName(){return"UiStylesBlock"}static get requires(){return[r,c]}}const a={UiStylesBlock:d}})(),s=s.default})()));